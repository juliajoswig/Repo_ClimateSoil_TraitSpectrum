origin = "/Users/jjoswig/Documents/_docs/03_projects/2020/002_Dichotomy/2019_Revision/20191004_Revision/R/Submission/01_Complete_for_submission"
#origin="/Net/Groups/BGI/work_1/2018_Dichotomy/FINAL/Submission/01_Complete_for_submission"
# origin = # please add your local path here & comment the ones below.
# load functions
source(file.path(origin,"scripts" ,"_master","fn_functions.R"))
# install packages if unloaded
source(file.path(origin,"scripts" ,"_master","fn_packages.R"))
#------------------------------------------------------------------------------------
# default: output_term = ""
# uncomment to activate woody or non-woody data set.
#------------------------------------------------------------------------------------
output_term = "" # defines with which subset the analysis will be done  (total)
# packages
library(vegan)
library(ks)
library(stats)
library(calibrate)
#-----------------
# load data
#-----------------
load(file.path(origin,"data","helper_files","fig_1b","PCA.RData"))   # load PCA
names(pca_FMr$var)
names(pca_FMr$var$coord)
colnames(pca_FMr$var$coord)
rownames(pca_FMr$var$coord)
barplot(pca_FMr$var$coord[,1],col=color_to_traits(rownames(pca_FMr$var$coord))
dev.off()
}
dev.off()
dev.off()
dev.off()
pca_FMr$var$coord[,1]
barplot(pca_FMr$var$coord[,1],col=color_to_traits(rownames(pca_FMr$var$coord)))
barplot(pca_FMr$var$coord[,2],col=color_to_traits(rownames(pca_FMr$var$coord)),add=TRUE)
par(mfrow=c(1,5))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(rownames(pca_FMr$var$coord)))
barplot(pca_FMr$var$coord[,2],col=color_to_traits(rownames(pca_FMr$var$coord)))
par(mfrow=c(1,5))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.6,.8))
barplot(pca_FMr$var$coord[,2],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.6,.8))
barplot(pca_FMr$var$coord[,3],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.6,.8))
barplot(pca_FMr$var$coord[,4],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.6,.8))
barplot(pca_FMr$var$coord[,5],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.6,.8))
par(mfrow=c(1,5))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.8,.8))
barplot(pca_FMr$var$coord[,2],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.8,.8))
barplot(pca_FMr$var$coord[,3],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.8,.8))
barplot(pca_FMr$var$coord[,4],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.8,.8))
barplot(pca_FMr$var$coord[,5],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-.8,.8))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1))
barplot(pca_FMr$var$coord[,2],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1))
barplot(pca_FMr$var$coord[,3],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1))
barplot(pca_FMr$var$coord[,4],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1))
barplot(pca_FMr$var$coord[,5],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1))
Rename_Vars(rownames(pca_FMr$var$coord) )[,3]
nms=rownames(pca_FMr$var$coord)
rownames(pca_FMr$var$coord) <- Rename_Vars(rownames(pca_FMr$var$coord) )[,3]
par(mfrow=c(1,5))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(nms),ylim=c(-1,1),las=2)
barplot(pca_FMr$var$coord[,2],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1),las=2)
barplot(pca_FMr$var$coord[,3],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1),las=2)
barplot(pca_FMr$var$coord[,4],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1),las=2)
barplot(pca_FMr$var$coord[,5],col=color_to_traits(rownames(pca_FMr$var$coord)),ylim=c(-1,1),las=2)
par(mfrow=c(1,5),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(nms),ylim=c(-1,1),las=2)
par(mfrow=c(1,5),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC1")
barplot(pca_FMr$var$coord[,2],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC2")
barplot(pca_FMr$var$coord[,3],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC3")
barplot(pca_FMr$var$coord[,4],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC4")
barplot(pca_FMr$var$coord[,5],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC5")
load(file.path(origin,"data","helper_files","fig_1b","PCA.RData"))   # load PCA
if(!dir.exists(file.path(origin,"figures","figure_S_PCA_loadings"))){
dir.create(file.path(origin,"figures","figure_S_PCA_loadings"))}
nms=rownames(pca_FMr$var$coord)
rownames(pca_FMr$var$coord) <- Rename_Vars(rownames(pca_FMr$var$coord) )[,3]
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings.pdf"),height=10,width=10)
par(mfrow=c(1,5),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC1")
barplot(pca_FMr$var$coord[,2],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC2")
barplot(pca_FMr$var$coord[,3],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC3")
barplot(pca_FMr$var$coord[,4],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC4")
barplot(pca_FMr$var$coord[,5],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC5")
dev.off()
plot_Figure_S_PCA_loadings <- function(origin){
# packages
library(vegan)
library(ks)
library(stats)
library(calibrate)
#-----------------
# load data
#-----------------
load(file.path(origin,"data","helper_files","fig_1b","PCA.RData"))   # load PCA
if(!dir.exists(file.path(origin,"figures","figure_S_PCA_loadings"))){
dir.create(file.path(origin,"figures","figure_S_PCA_loadings"))}
nms=rownames(pca_FMr$var$coord)
rownames(pca_FMr$var$coord) <- Rename_Vars(rownames(pca_FMr$var$coord) )[,3]
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings.pdf"),height=10,width=10)
par(mfrow=c(1,5),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC1")
barplot(pca_FMr$var$coord[,2],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC2")
barplot(pca_FMr$var$coord[,3],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC3")
barplot(pca_FMr$var$coord[,4],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC4")
barplot(pca_FMr$var$coord[,5],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC5")
dev.off()
}
plot_Figure_S_PCA_loadings(origin)
pca_FMr
pca_FMr$eig
pca_FMr$eig[,1]
pca_FMr$eig[,2]
barplot(pca_FMr$eig[,2],ylim=c(-1,1),las=2)
barplot(pca_FMr$eig[,2],las=2)
pca_FMr$eig[,2]
barplot(pca_FMr$eig[,1],las=2)
barplot(pca_FMr$eig[,3],las=2)
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=10,width=5)
par(mfrow=c(1,2),mar=c(10,2,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=5,width=5)
par(mfrow=c(1,2),mar=c(10,2,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
dev.off()
par(mfrow=c(1,2),mar=c(4,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=5,width=5)
par(mfrow=c(1,2),mar=c(4,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=8,width=5)
par(mfrow=c(1,2),mar=c(4,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=8,width=5)
par(mfrow=c(1,2),mar=c(6,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
dev.off()
abline(h = 50,col="red")
abline(h = 10,col="red")
par(mfrow=c(1,2),mar=c(6,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
abline(h = 10,col="red")
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=8,width=9)
par(mfrow=c(1,2),mar=c(6,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col)
abline(h = 10,col="red")
barplot(pca_FMr$eig[,3],las=2,col=climate_col)
abline(h = 50,col="red")
dev.off()
pca_FMr$eig
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=8,width=9)
par(mfrow=c(1,2),mar=c(6,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col,ylab="Percentage of variance")
abline(h = 10,col="red")
barplot(pca_FMr$eig[,3],las=2,col=climate_col,ylab="Cumulative percentage of variance")
abline(h = 50,col="red")
dev.off()
barplot(pca_FMr$eig[,2],las=2,col=soil_col,ylab="Percentage of variance",cex.lab=2)
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=8,width=9)
par(mfrow=c(1,2),mar=c(6,4,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col,ylab="Percentage of variance",cex.lab=2)
abline(h = 10,col="red")
barplot(pca_FMr$eig[,3],las=2,col=climate_col,ylab="Cumulative percentage of variance",cex.lab=2)
abline(h = 50,col="red")
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=8,width=9)
par(mfrow=c(1,2),mar=c(6,5,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col,ylab="Percentage of variance",cex.lab=2)
abline(h = 10,col="red")
barplot(pca_FMr$eig[,3],las=2,col=climate_col,ylab="Cumulative percentage of variance",cex.lab=2)
abline(h = 50,col="red")
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings.pdf"),height=10,width=10)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[,1],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC1")
barplot(pca_FMr$var$coord[,2],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC2")
barplot(pca_FMr$var$coord[,3],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC3")
barplot(pca_FMr$var$coord[,4],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC4")
barplot(pca_FMr$var$coord[,5],col=color_to_traits(nms),ylim=c(-1,1),las=2,ylab="Loading PC5")
dev.off()
target_order
target_order1=c("SeLen","DispULen","SeedMass","PlantHeight","LeFMass","LeArea","ConduitDens",
"SSD","LeC","LeNP","LeP","LeNArea","SLA","LeN", "VesLen","Led15N","SenbU")
ix= match(nms,target_order1)
ix
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[ix,1],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC1")
barplot(pca_FMr$var$coord[ix,2],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC2")
ix= match(target_order1,nms)
ix= match(target_order1,nms)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[ix,1],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC1")
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings.pdf"),height=10,width=10)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[ix,1],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC1")
barplot(pca_FMr$var$coord[ix,2],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC2")
barplot(pca_FMr$var$coord[ix,3],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC3")
barplot(pca_FMr$var$coord[ix,4],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC4")
barplot(pca_FMr$var$coord[ix,5],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC5")
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings_abs.pdf"),height=10,width=10)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(abs(pca_FMr$var$coord[ix,1]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC1")
barplot(abs(pca_FMr$var$coord[ix,2]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC2")
barplot(abs(pca_FMr$var$coord[ix,3]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC3")
barplot(abs(pca_FMr$var$coord[ix,4]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC4")
barplot(abs(pca_FMr$var$coord[ix,5]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC5")
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings.pdf"),height=10,width=10)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[ix,1],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC1",main="PC1")
barplot(pca_FMr$var$coord[ix,2],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC2",main="PC2")
barplot(pca_FMr$var$coord[ix,3],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC3",main="PC3")
barplot(pca_FMr$var$coord[ix,4],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC4",main="PC4")
barplot(pca_FMr$var$coord[ix,5],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC5",main="PC5")
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings_abs.pdf"),height=10,width=10)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(abs(pca_FMr$var$coord[ix,1]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC1",main="PC1")
barplot(abs(pca_FMr$var$coord[ix,2]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC2",main="PC2")
barplot(abs(pca_FMr$var$coord[ix,3]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC3",main="PC3")
barplot(abs(pca_FMr$var$coord[ix,4]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC4",main="PC4")
barplot(abs(pca_FMr$var$coord[ix,5]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC5",main="PC5")
dev.off()
barplot(pca_FMr$var$coord[ix,1],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC1",main="PC1",cex.main=2)
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings.pdf"),height=10,width=10)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(pca_FMr$var$coord[ix,1],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC1",main="PC1",cex.main=2)
barplot(pca_FMr$var$coord[ix,2],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC2",main="PC2",cex.main=2)
barplot(pca_FMr$var$coord[ix,3],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC3",main="PC3",cex.main=2)
barplot(pca_FMr$var$coord[ix,4],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC4",main="PC4",cex.main=2)
barplot(pca_FMr$var$coord[ix,5],col=color_to_traits(nms)[ix],ylim=c(-1,1),las=2,ylab="Loading PC5",main="PC5",cex.main=2)
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_loadings_abs.pdf"),height=10,width=10)
par(mfrow=c(2,3),mar=c(10,2,2,2))
barplot(abs(pca_FMr$var$coord[ix,1]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC1",main="PC1",cex.main=2)
barplot(abs(pca_FMr$var$coord[ix,2]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC2",main="PC2",cex.main=2)
barplot(abs(pca_FMr$var$coord[ix,3]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC3",main="PC3",cex.main=2)
barplot(abs(pca_FMr$var$coord[ix,4]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC4",main="PC4",cex.main=2)
barplot(abs(pca_FMr$var$coord[ix,5]),col=color_to_traits(nms)[ix],ylim=c(0,1),las=2,ylab="Loading PC5",main="PC5",cex.main=2)
dev.off()
dim(pca_FMr$var$coord)
dim(pca_FMr$ind$coord)
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=6,width=9)
par(mfrow=c(1,2),mar=c(6,5,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col,ylab="Percentage of variance",cex.lab=2)
abline(h = 10,col="red")
barplot(pca_FMr$eig[,3],las=2,col=climate_col,ylab="Cumulative percentage of variance",cex.lab=2)
abline(h = 50,col="red")
dev.off()
pdf(file=file.path(origin, "figures","figure_S_PCA_loadings","figure_S1_PCA_evplvar.pdf"),height=6,width=9)
par(mfrow=c(1,2),mar=c(6,5,2,2))
barplot(pca_FMr$eig[,2],las=2,col=soil_col,ylab="Percentage of variance",cex.lab=1.5)
abline(h = 10,col="red")
barplot(pca_FMr$eig[,3],las=2,col=climate_col,ylab="Cumulative percentage of variance",cex.lab=1.5)
abline(h = 50,col="red")
dev.off()
